# Invoke-WDACSimulation available parameters

## Notes

* **Mandatory** parameters indicate you always need to provide values for them.

* **Automatic** parameters indicate that if you used [Set-CommonWDACConfig](https://github.com/HotCakeX/Harden-Windows-Security/wiki/Set-CommonWDACConfig) cmdlet to set default values for them, the module will automatically use them. This saves time and prevents repetitive tasks. However, if no value exists in User Configurations for an Automatic parameter and you didn't explicitly provide a value for that parameter either, then you will see an error asking you to provide value for it. Explicitly providing a value for an Automatic parameter in the command line overrides its default value in User Configurations, meaning the module will ignore the value of the same parameter in the User Configurations file.

* **Optional** parameters indicate that they are not required and without using them the module will automatically run with the optimal settings.

* Many cmdlets and parameters of the module support the PowerShell's built-in `-Debug` switch and when that switch is used, they display extra details and debugging messages on the console, showing you what's happening under the hood.

<br>

![image](https://raw.githubusercontent.com/HotCakeX/.github/main/Pictures/Wiki%20APNGs/Invoke-WDACSimulation/Invoke-WDACSimulation.apng)

```powershell
Invoke-WDACSimulation -FolderPath <string> -XmlFilePath <string>
```

<br>

This cmdlet allows you to simulate a WDAC deployment. Select a folder and a policy xml file, it will show you whether the files in the folder would be allowed or blocked by your WDAC policy if it was actually deployed on a system and those files were run.

You will get a CSV file in the current working directory for the output of the simulation with full details of each file that would be blocked/allowed by the selected policy.

<br>

**Current limitations of this cmdlet that will be fixed in future module version**

1. Currently, this cmdlet is only suitable for xml policy files generated by **Level: FilePublisher** and **Fallback: Hash**, [which are actually the safest and best options](https://github.com/HotCakeX/Harden-Windows-Security/wiki/WDAC-Notes#file-rule-levels-security). If the policy was generated by other levels and fallbacks such as filepaths, the output of this cmdlet will not be accurate.

2. In some edge cases, WDAC cmdlets such as `New-CiPolicy` create hash rules for a digitally valid signed file instead of creating Signer rules which are based on file's digital signature. In such cases, if there is a Signer in the Signers section of the xml policy that matches the details of this specific signed file (Intermediate certificate + TBS + Leaf cert's CN), `Invoke-WDACSimulation` cmdlet shows that the file is allowed by Signer instead of hash, which is not true.

*This is the newest addition to the WDACConfig module.*

<br>

### 2 mandatory parameters

* `-FolderPath <string>`: Path to a folder. Supports argument tab completion, select the parameter then press TAB to open the Folder picker GUI.

* `-XmlFilePath <string>`: Path to a xml file. Supports argument tab completion, select the parameter then press TAB to open the file picker that shows only xml files.

<br>

<img src="https://github.com/HotCakeX/Harden-Windows-Security/raw/main/images/Gifs/1pxRainbowLine.gif" width= "300000" alt="horizontal super thin rainbow RGB line">

<br>

#### External Licenses

A small part of this cmdlet's code includes Vadims PodƒÅns's code for nested certificate calculation of double signed files.
1. https://www.sysadmins.lv/disclaimer.aspx
2. https://www.sysadmins.lv/blog-en/reading-multiple-signatures-from-signed-file-with-powershell.aspx

<br>
