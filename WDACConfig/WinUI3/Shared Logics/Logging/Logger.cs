#nullable enable

namespace WDACConfig
{
    public static class Logger
    {
        /// <summary>
        /// Write a verbose message to the console
        /// https://learn.microsoft.com/en-us/dotnet/api/system.management.automation.host.pshostuserinterface
        /// </summary>
        /// <param name="message"></param>
        public static void Write(string message)
        {
            try
            {
                if (GlobalVars.VerbosePreference)
                {
                    // The messages generated by WriteVerboseLine method are normally not redirected on the PowerShell console,
                    // But the PowerShellExecutor.ExecuteScript() method in the Harden Windows Security, that runs PowerShell commands using Management.Automation namespace,
                    // Captures and redirects them to the GUI's textbox, just like the regular Write-Verbose messages.
                    GlobalVars.Host?.UI.WriteVerboseLine(message);
                }
            }
            // Do not do anything if errors occur
            // Since many methods write to the console asynchronously this can throw errors
            catch { }
        }
    }
}
